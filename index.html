<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Kazz Second Branded</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>KAZZ SECOND BRANDED</h1>
  <p>Outfit kekinian â€¢ Sepatu â€¢ Hoodie â€¢ Jaket â€¢ Crewneck</p>
  <p>ðŸ“ž 08xxxxxxxxxx</p>
  <button onclick="checkout()">Checkout WhatsApp</button>
</header>

<section class="grid" id="products"></section>

<footer>
  <p>Â© 2026 Kazz Second Branded</p>
</footer>

<!-- ================= FIREBASE SDK ================= -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- ================= FIREBASE CONFIG ================= -->
<script src="firebase.js"></script>

<!-- ================= MAIN SCRIPT ================= -->
<script>
let cart = [];

db.collection("products").onSnapshot(snapshot => {
  const el = document.getElementById("products");
  el.innerHTML = "";

  snapshot.forEach(doc => {
    const p = doc.data();
    const sold = p.stock <= 0;

    el.innerHTML += `
      <div class="card ${sold ? 'sold' : ''}">
        <img src="${p.img}">
        <h4>${p.name}</h4>
        <p>Rp ${p.price}</p>
        <p>${sold ? "SOLD OUT" : "Stok: " + p.stock}</p>
        <button ${sold ? "disabled" : ""} onclick="add('${doc.id}','${p.name}',${p.price})">
          ${sold ? "Habis" : "Tambah"}
        </button>
      </div>
    `;
  });
});

function add(id,name,price){
  cart.push({id,name,price});
}

function checkout(){
  if(cart.length === 0){
    alert("Keranjang kosong");
    return;
  }

  let msg = "Halo Kazz Second, saya mau order:%0A";
  cart.forEach(c => {
    msg += `- ${c.name} Rp ${c.price}%0A`;
    db.collection("products").doc(c.id)
      .update({stock: firebase.firestore.FieldValue.increment(-1)});
  });

  window.open("https://wa.me/628XXXXXXXXXX?text=" + msg);
  cart = [];
}
</script>

</body>
</html>
